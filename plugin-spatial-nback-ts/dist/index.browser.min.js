var jsPsychPluginSpatialNbackTs=function(r){"use strict";var I="0.0.1";const N={name:"plugin-spatial-nback-ts",version:I,parameters:{rows:{type:r.ParameterType.INT,default:3},cols:{type:r.ParameterType.INT,default:3},cell_size:{type:r.ParameterType.INT,default:100},stimulus_row:{type:r.ParameterType.INT,default:0},stimulus_col:{type:r.ParameterType.INT,default:0},is_target:{type:r.ParameterType.BOOL,default:!1},stimulus_duration:{type:r.ParameterType.INT,default:500},isi_duration:{type:r.ParameterType.INT,default:1e3},show_feedback:{type:r.ParameterType.BOOL,default:!0},showFeedbackNoResponse:{type:r.ParameterType.BOOL,default:!0},show_feedback_border:{type:r.ParameterType.BOOL,default:!0},feedback_duration:{type:r.ParameterType.INT,default:500},feedbackWaitNoResponse:{type:r.ParameterType.BOOL,default:!0},button_text:{type:r.ParameterType.STRING,default:""},stimulus_color:{type:r.ParameterType.STRING,default:"#0066cc"},correct_color:{type:r.ParameterType.STRING,default:"#00cc00"},incorrect_color:{type:r.ParameterType.STRING,default:"#cc0000"},instructions:{type:r.ParameterType.STRING,default:"Click MATCH when this is a target trial."}},data:{stimulus_row:{type:r.ParameterType.INT},stimulus_col:{type:r.ParameterType.INT},is_target:{type:r.ParameterType.BOOL},response:{type:r.ParameterType.BOOL},response_time:{type:r.ParameterType.INT},correct:{type:r.ParameterType.BOOL}},citations:{apa:"A. Hunter Farhat A. Hunter Farhat, A. H. F. (2023). {title}. Journal for Open Source Software, 1(1), 1. https://doi.org/10.21105/joss.12345 ",bibtex:"@article{Hunter2023title, 	author = {A. Hunter Farhat A. Hunter Farhat, A. Hunter Farhat}, 	journal = {Journal for Open Source Software}, 	doi = {10.21105/joss.12345}, 	issn = {1234-5678}, 	number = {1}, 	year = {2023}, 	month = {may 11}, 	pages = {1}, 	publisher = {Open Journals}, 	title = {\\textbraceleft{}title\\textbraceright{}}, 	url = {{linkToPublicationInJournal}}, 	volume = {1}, }  "}};class T{constructor(p){this.jsPsych=p}trial(p,e){var w,h;let c,d=!1,m=!1,k,g,u=!1;const b=(w=e.stimulus_row)!=null?w:Math.floor(Math.random()*e.rows),f=(h=e.stimulus_col)!=null?h:Math.floor(Math.random()*e.cols),O=()=>{let t=`
        <div id="nback-container" style="
          position: fixed;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          width: 100vw;
          height: 100vh;
          display: flex;
          flex-direction: column;
          justify-content: center;
          align-items: center;
          font-family: Arial, sans-serif;
          box-sizing: border-box;
          padding: 20px;
        ">`;t+=`<div id="nback-instructions" style="
        position: absolute;
        top: 15vh;
        left: 50%;
        transform: translateX(-50%);
        width: 80%;
        max-width: 520px;
        text-align: center;
        font-size: clamp(14px, 2vmin, 18px);
        z-index: 10;
      ">${e.instructions}</div>`;const a=`${Math.min(50,80/Math.max(e.rows,e.cols))/Math.max(e.rows,e.cols)}vmin`;t+=`<div id="nback-grid" style="
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        border: 2px solid #000;
        box-sizing: border-box;
        display: inline-block;
        z-index: 5;
      ">`;for(let n=0;n<e.rows;n++){t+='<div style="display: flex;">';for(let i=0;i<e.cols;i++)t+=`<div id="cell-${n}-${i}" style="
            width: ${a};
            height: ${a};
            border: 1px solid #ccc;
            background-color: white;
            box-sizing: border-box;
            min-width: ${Math.max(40,e.cell_size*.5)}px;
            min-height: ${Math.max(40,e.cell_size*.5)}px;
          "></div>`;t+="</div>"}t+="</div>",t+=`<div id="nback-button-container" style="
        position: absolute;
        bottom: 15vh;
        left: 50%;
        transform: translateX(-50%);
        z-index: 10;
      ">`,t+=`<button id="nback-response-btn" style="
        font-size: clamp(18px, 3vmin, 26px);
        padding: clamp(18px, 2.5vmin, 30px) clamp(35px, 5vmin, 60px);
        background-color: #2196F3;
        color: white;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        font-weight: bold;
        box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        transition: all 0.2s;
      " disabled>${e.button_text}</button>`,t+="</div>",t+=`<div id="nback-feedback" style="
        position: absolute;
        bottom: 8vh;
        left: 50%;
        transform: translateX(-50%);
        height: 40px;
        font-size: clamp(14px, 2vmin, 20px);
        font-weight: bold;
        text-align: center;
        z-index: 10;
        width: 80%;
      "></div>`,t+="</div>",p.innerHTML=t;const o=document.getElementById("nback-response-btn");o.addEventListener("mouseenter",()=>{o.disabled||(o.style.backgroundColor="#1976D2",o.style.transform="translateY(-2px)")}),o.addEventListener("mouseleave",()=>{o.style.backgroundColor="#2196F3",o.style.transform="translateY(0)"}),o.addEventListener("click",B)},M=()=>{const t=document.getElementById(`cell-${b}-${f}`);t.style.backgroundColor=e.stimulus_color,d=!0,c=performance.now(),u=!1;const a=document.getElementById("nback-response-btn");a.disabled=!1,k=window.setTimeout(()=>{t.style.backgroundColor="white",u=!0,g=window.setTimeout(()=>{d&&!m&&$()},e.isi_duration)},e.stimulus_duration)},B=()=>{if(!d||m)return;d=!1,m=!0;const t=performance.now()-c,a=e.is_target;clearTimeout(k),clearTimeout(g),v(a,t,!0)},$=()=>{if(!d||m)return;d=!1,m=!0;const t=!e.is_target;v(t,null,!1)},v=(t,a,o)=>{if(!e.show_feedback&&!e.show_feedback_border){if(o&&!u){const l=performance.now()-c,x=Math.max(0,e.stimulus_duration-l)+e.feedback_duration;setTimeout(()=>{const _=document.getElementById(`cell-${b}-${f}`);_.style.backgroundColor="white",setTimeout(()=>{s(t,a,o)},e.isi_duration)},x)}else s(t,a,o);return}const n=document.getElementById("nback-response-btn");n.disabled=!0,n.style.opacity="0.6";let i;if(o&&!u){const l=performance.now()-c;i=Math.max(0,e.stimulus_duration-l)+e.feedback_duration}else if(o&&u){const l=performance.now()-c,x=e.stimulus_duration,_=l-x;i=Math.max(0,e.isi_duration-_)+e.feedback_duration}else if(e.feedbackWaitNoResponse)i=e.feedback_duration;else{s(t,a,o);return}if(a===null&&!e.showFeedbackNoResponse){e.feedbackWaitNoResponse?setTimeout(()=>{s(t,a,o)},i):s(t,a,o);return}const P=document.getElementById("nback-grid"),y=document.getElementById("nback-feedback");if(e.show_feedback_border&&(P.style.border=`6px solid ${t?e.correct_color:e.incorrect_color}`),e.show_feedback){let l=t?"Correct!":"Incorrect!";a!==null&&(l+=` (${Math.round(a)}ms)`),y.textContent=l,y.style.color=t?e.correct_color:e.incorrect_color}setTimeout(o&&!u?()=>{e.show_feedback_border&&(P.style.border="2px solid #000"),e.show_feedback&&(y.textContent=""),setTimeout(()=>{s(t,a,o)},e.isi_duration)}:()=>{s(t,a,o)},i)},s=(t,a,o)=>{const n={stimulus_row:b,stimulus_col:f,is_target:e.is_target,response:o,response_time:a,correct:t};p.innerHTML="",this.jsPsych.finishTrial(n)};O(),M()}}return T.info=N,T}(jsPsychModule);
//# sourceMappingURL=index.browser.min.js.map
